<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        #mainScreen {
            width: 100%;
            height: 100%;
            background-color: #efefef;
            text-align: center;
        }
        #lobby {
            display: none;
        }
        #game {
            display: none;
        }
        #level1 {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/png;base64,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') no-repeat center center;
            background-size: cover;
        }
    </style>
    <title>Snail VS Cat Tower Defence</title>
</head>
<body>
    <div id="mainScreen">
        <div id="title">
            <h1>Snail VS Cat Tower Defence!</h1>
            <p>Who Shall Win?</p>
        </div>
        <div id="nameScreen">
            <input id="nameInput" >
            <button id="nameBtn">Go!</button>
            <p id="errMsg" style="color: red;"></p>
        </div>
        <div id="lobby">
            <button id="lookForGame">look for game</button>
        </div>
    </div>
    <div id="game">
        <div id="level1"></div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        var team = undefined;
        var matchmaking = false;
        var gameId = "";
        if (getCookie("name")) {
            var name = getCookie("name");
            document.getElementById("lobby").style.display = "block";
            document.getElementById("nameScreen").style.display = "none";
            connected()
        }
        document.getElementById("nameBtn").addEventListener("click", () => {
            var name = encodeURIComponent(document.getElementById("nameInput").value);
            setCookie("name", name, 999999);
            document.getElementById("lobby").style.display = "block";
            document.getElementById("nameScreen").style.display = "none";
            connected()
        });
        document.getElementById("lookForGame").addEventListener("click", () => {
            socket.emit("matchmaking");
            matchmaking = true;
        })
        function connected() {
            document.getElementById("nameInput").style.display = "none";
            socket.emit("connected", name)
            socket.emit("refreshNames");
            if (location.hash) {
                gameId = location.hash;
                loadGame();
            }
        }
        function loadGame() {
            document.getElementById("mainScreen").style.display = "none";
            socket.emit("teamSelect", gameId);
            var awaitingTeam = true;
            socket.on(gameId + "team", (teamId) => {
                if (awaitingTeam == true) {
                    awaitingTeam = false;
                    if (teamId == 1) {
                        team = "Snail";
                    }
                    else {
                        team = "Cat";
                    }
                    console.log(teamId);
                    document.getElementById("game").style.display = "block";
                }
            });
        }
        socket.on("matchmaking", () => {
            if (matchmaking == true) {
                socket.emit("matched", socket.id.split("-").toString());
            }
        })
        socket.on("matched", (id) => {
            if (matchmaking == true) {
                location.hash = id;
                location.reload();
            }
        })
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

            function setCookie(cname, cvalue, exdays) {
                const d = new Date();
                d.setTime(d.getTime() + (exdays*24*60*60*1000));
                let expires = "expires="+ d.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }
    </script>
</body>
</html>